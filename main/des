main code with segmentation and models
